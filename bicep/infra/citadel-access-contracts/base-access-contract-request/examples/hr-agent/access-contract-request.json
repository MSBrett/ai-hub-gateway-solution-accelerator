{
  "$schema": "../../access-contract-request.schema.json",
  "contractInfo": {
    "businessUnit": "HR",
    "useCaseName": "ChatAgent",
    "environment": "DEV",
    "description": "HR Chat Agent with full policy suite - model-specific capacity, content safety, PII anonymization/deanonymization with state saving, usage tracking with custom dimensions, and throttling alerts.",
    "productTerms": "This service is for HR department use only. PII handling is enabled with anonymization/deanonymization. All usage is subject to HR department policies."
  },
  "infrastructure": {
    "apim": {
      "subscriptionId": "00000000-0000-0000-0000-000000000000",
      "resourceGroupName": "rg-apim-resource-group",
      "name": "apim-instance-name"
    },
    "keyVault": {
      "enabled": true,
      "subscriptionId": "00000000-0000-0000-0000-000000000000",
      "resourceGroupName": "rg-keyvault-resource-group",
      "name": "kv-instance-name"
    },
    "foundry": {
      "enabled": false
    }
  },
  "apiNameMapping": {
    "LLM": ["universal-llm-api", "azure-openai-api"]
  },
  "services": [
    {
      "code": "LLM",
      "endpointSecretName": "HR-CHATAGENT-LLM-ENDPOINT",
      "apiKeySecretName": "HR-CHATAGENT-LLM-KEY"
    }
  ],
  "policies": {
    "modelAccess": {
      "enabled": true,
      "allowedModels": ["gpt-4o", "text-embedding-3-large", "deepseek-r1"]
    },
    "capacityManagement": {
      "enabled": true,
      "mode": "per-model",
      "perModel": [
        {
          "model": "gpt-4o",
          "tokensPerMinute": 5000,
          "tokenQuota": 500000,
          "tokenQuotaPeriod": "Monthly"
        },
        {
          "model": "deepseek-r1",
          "tokensPerMinute": 2000,
          "tokenQuota": 200000,
          "tokenQuotaPeriod": "Monthly"
        },
        {
          "model": "text-embedding-3-large",
          "tokensPerMinute": 3000,
          "tokenQuota": 300000,
          "tokenQuotaPeriod": "Monthly"
        }
      ],
      "defaultModel": {
        "tokensPerMinute": 500,
        "tokenQuota": 50000,
        "tokenQuotaPeriod": "Monthly"
      }
    },
    "contentSafety": {
      "enabled": true,
      "shieldPrompt": true,
      "categories": [
        { "name": "Hate", "threshold": 4 },
        { "name": "Violence", "threshold": 4 }
      ]
    },
    "piiHandling": {
      "enabled": true,
      "mode": "anonymize",
      "confidenceThreshold": "0.8",
      "entityCategoryExclusions": "PersonType",
      "language": "en",
      "stateSaving": true,
      "customRegexPatterns": [
        {
          "pattern": "\\b\\d{4}[- ]?\\d{4}[- ]?\\d{4}[- ]?\\d{4}\\b",
          "category": "CREDIT_CARD"
        },
        {
          "pattern": "\\b[A-Z]{2}\\d{6}[A-Z]\\b",
          "category": "PASSPORT_NUMBER"
        },
        {
          "pattern": "\\b784-\\d{4}-\\d{7}-\\d{1}\\b",
          "category": "EMIRATES_ID"
        }
      ]
    },
    "usageTracking": {
      "enabled": true,
      "appIdHeader": "x-app-id",
      "customDimension1": {
        "header": "x-sub-agent-id",
        "default": "general-agent"
      },
      "customDimension2": {
        "header": "x-enduser-id",
        "default": "anonymous-enduser"
      }
    },
    "alerts": {
      "enabled": true,
      "throttlingEvents": true
    }
  }
}
