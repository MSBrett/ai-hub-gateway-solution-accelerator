        <!-- Usage Tracking - Custom dimensions for LLM usage reporting -->
        <set-variable name="appId" value="@{
            var requestedAppId = context.Request.Headers.ContainsKey("{{APP_ID_HEADER}}") ? context.Request.Headers["{{APP_ID_HEADER}}"][0] : null;
            if (!string.IsNullOrEmpty(requestedAppId))
            {
                return requestedAppId;
            }
            return context.Subscription?.Id ?? "Portal-Admin";
        }" />
        <set-variable name="customDimension1" value="@(context.Request.Headers.ContainsKey("{{CD1_HEADER}}") ? context.Request.Headers["{{CD1_HEADER}}"][0] : "{{CD1_DEFAULT}}")" />
        <set-variable name="customDimension2" value="@(context.Request.Headers.ContainsKey("{{CD2_HEADER}}") ? context.Request.Headers["{{CD2_HEADER}}"][0] : "{{CD2_DEFAULT}}")" />